{"version":3,"sources":["uni-app:///main.js","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?4341","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?c5e4","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?420f","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?60fa","uni-app:///pages/parkinglotnavigation/parkingLotNavigation.vue","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?f74a","webpack:///E:/finalproject/ParkingLotMobile/pages/parkinglotnavigation/parkingLotNavigation.vue?b971"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","key","data","msgType","messageText","userLatitude","userLongitude","customerLocation","close_empty_pl","markers","polyline","parkinglots","windowHeight","timer","onReady","onLoad","onShow","uni","success","console","scope","that","fail","title","content","cancelText","cancelColor","confirmText","confirmColor","onHide","clearInterval","onUnload","methods","main","FindCloseParkingLot","minDistance","id","width","height","longitude","latitude","iconPath","callout","fontSize","borderRadius","borderWidth","bgColor","display","MarkCustomerLocation","type","GetCustomerLocation","geocode","isHighAccuracy","GetParkingLotLocations","url","Direction","qqmapsdk","mode","from","to","pl","coors","points","color","ComputeDistance","messageBox"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,6BAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiI;AACjI;AACwE;AACL;AACa;;;AAGhF;AAC0L;AAC1L,gBAAgB,mMAAU;AAC1B,EAAE,0FAAM;AACR,EAAE,+FAAM;AACR,EAAE,wGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,+PAEN;AACP,KAAK;AACL;AACA,aAAa,sWAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAutB,CAAgB,4uBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACkB3uB;;;;;;;;;;;;;;;;;;;AAMA;AACA;EACAC;AACA;AAAA,eACA;EACAC;IACA;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACAC;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;IACA;EACA;EACAC;IACA;IACA;EAEA;EACAC,2BAEA;EACAC;IACA;IACA;IACAC;MACAC;QACAC;QACA;QACA;UACA;UACAF;YACAG;YACAF;cACA;cACAG;YACA;YACAC;cACA;cACAH;cACA;cACAF;gBACAM;gBACAC;gBACAC;gBACAC;gBACAC;gBACAC;gBACAV;kBACA;oBACA;oBACAD;sBACAC;wBACAC;sBACA;oBACA;kBACA;oBACA;oBACAA;kBACA;gBACA;cACA;YACA;UACA;QACA;QACA;QAAA,KACA;UACA;UACAE;QACA;MACA;IACA;EACA;EACA;EACAQ;IACA;IACAC;IACA;IACAX;IACAA;EACA;EACA;EACAY;IACA;IACAD;IACA;IACAX;IACAA;EACA;EAEAa;IACA;IACAC;MACA;MACA;MACAhB;QACAC;UACAG;QACA;MACA;MACA;MACAA;MACA;MACAA;MACA;MACAA;QACAA;MACA;IACA;IACA;IACAa;MACAf;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA,wCACA;QACA;QACA;QACA;UACAgB;UACA;UACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;UACAlB;UACAmB;UAAA;UACAC;UAAA;UACAC;UACAC;UAAA;UACAC;QACA;MACA;MACA;MACA;QACAX;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;UACAlB;UACAmB;UAAA;UACAC;UAAA;UACAC;UACAC;UAAA;UACAC;QACA;MACA,EACA;IACA;IACA;IACAC;MACA;MACA/B;QACAgC;QACA;QACA;QACA/B;UACAC;UACAE;UACAA;UACA;UACA;YACAA;cACAe;cACAC;cACAC;cACAC;cACAC;cACAC;YACA;UACA;YACApB;YACAA;cACAe;cACAC;cACAC;cACAC;cACAC;cACAC;YACA;UACA;QACA;QACAnB;UACAH;QACA;MACA;IACA;IACA;IACA+B;MACA;MACAjC;QACAgC;QACAE;QAAA;QACAC;QACAlC;UACAD;UACAI;UACAA;QACA;QACAC;UACAH;QACA;MACA;IACA;IACA;IACAkC;MACAlC;MACA;MACAF;QACAqC;QACApC;UACAC;UACAF;UACA;QACA;MACA;IACA;IACA;IACAsC;MACA;MACA;MACA;MACA;MACA;MACA;MACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAzC;UACA;UACA;YAAA0C;UACA;UACA;UACA;YACAC;UACA;UACA;UACA;YACAD;cAAApB;cAAAD;YAAA;UACA;UACA;UACAlB,gCACAA,kCACAA;YACAyC;YACAC;YACA1B;UACA;QACA;QACAf;UACAH;QACA;MACA;IACA;IACA;IACA6C;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;EACA;AAEA;AAAA,2B;;;;;;;;;;;;;AChVA;AAAA;AAAA;AAAA;AAAmhC,CAAgB,6gCAAG,EAAC,C;;;;;;;;;;;ACAviC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/parkinglotnavigation/parkingLotNavigation.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/parkinglotnavigation/parkingLotNavigation.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./parkingLotNavigation.vue?vue&type=template&id=35f80d26&\"\nvar renderjs\nimport script from \"./parkingLotNavigation.vue?vue&type=script&lang=js&\"\nexport * from \"./parkingLotNavigation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./parkingLotNavigation.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/parkinglotnavigation/parkingLotNavigation.vue\"\nexport default component.exports","export * from \"-!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkingLotNavigation.vue?vue&type=template&id=35f80d26&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    uniPopupMessage: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup-message/uni-popup-message\" */ \"@/uni_modules/uni-popup/components/uni-popup-message/uni-popup-message.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkingLotNavigation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkingLotNavigation.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view id=\"mapbox\">\r\n\t\t\t<map ref=\"mymap\" id=\"mymap\" :style=\"{height:windowHeight + 'px'}\"\r\n\t\t\t:latitude=\"userLatitude\" :longitude=\"userLongitude\" :markers=\"markers\" :polyline=\"polyline\"\r\n\t\t\t rotate=0 ></map>\r\n\t\t</view> \r\n\t\t <!-- :markers=\"markers\" :polyline=\"polyline\" -->\r\n\t\t<!-- 提示信息弹窗 -->\r\n\t\t<view>\r\n\t\t\t<uni-popup ref=\"message\" type=\"message\">\r\n\t\t\t\t<uni-popup-message :type=\"msgType\" :message=\"messageText\" :duration=\"2000\"></uni-popup-message>\r\n\t\t\t</uni-popup>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script>\r\n\timport {\r\n\t\tmapState,\r\n\t\tmapMutations,\r\n\t\tmapGetters,\r\n\t\tmapActions\r\n\t} from 'vuex'\r\n\tvar QQMapWX = require('@/utils/qqmap-wx-jssdk.min.js')\r\n\tvar qqmapsdk = new QQMapWX({\r\n\t\t\tkey: 'U67BZ-GJTEX-V464V-ZC7IB-J23R7-V2F4Y'\r\n\t\t})\r\nexport default {\r\n\tdata(){\r\n\t\treturn{\r\n\t\t\t//消息盒子类型\r\n\t\t\tmsgType: '',\r\n\t\t\t//消息盒子内容\r\n\t\t\tmessageText: '',\r\n\t\t\t//地图初始化中心点，默认为用户当前定位\r\n\t\t\tuserLatitude:0,\r\n\t\t\tuserLongitude:0,\r\n\t\t\tcustomerLocation:'',\r\n\t\t\t//最近且有空位的停车场信息\r\n\t\t\tclose_empty_pl:'',\r\n\t\t\t//地图标记\r\n\t\t\tmarkers:[],\r\n\t\t\t//规划路线\r\n\t\t\tpolyline:[],\r\n\t\t\t//停车场信息\r\n\t\t\tparkinglots:[],\r\n\t\t\t//用户设备高度信息\r\n\t\t\twindowHeight:0,\r\n\t\t\t//计时器\r\n\t\t\ttimer:null,\r\n\t\t} \r\n\t},\r\n\tonReady() {\r\n\t\t//创建地图画布\r\n\t\tthis.mapContext = uni.createMapContext('mymap',this);\r\n\t\t\r\n\t},\r\n\tonLoad(){\r\n\t\t\r\n\t},\r\n\tonShow() {\r\n\t\tvar that = this;\r\n\t\t//获取用户授权后定位位置信息\r\n\t\tuni.getSetting({\r\n\t\t\tsuccess(res) {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\t// 如果没有授权\r\n\t\t\t\tif (!res.authSetting['scope.userLocation']) {\r\n\t\t\t\t\t// 则拉起授权窗口\r\n\t\t\t\t\tuni.authorize({\r\n\t\t\t\t\t\tscope: 'scope.userLocation',\r\n\t\t\t\t\t\tsuccess(){\r\n\t\t\t\t\t\t\t//进入程序主方法\r\n\t\t\t\t\t\t\tthat.main();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(error) {\r\n\t\t\t\t\t\t\t//点击了拒绝授权后--就一直会进入失败回调函数--此时就可以在这里重新拉起授权窗口\r\n\t\t\t\t\t\t\tconsole.log('拒绝授权', error)\r\n\t\t\t\t\t\t\t//提示\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\tcontent: '若点击不授权，将无法使用位置功能',\r\n\t\t\t\t\t\t\t\tcancelText: '不授权',\r\n\t\t\t\t\t\t\t\tcancelColor: '#999',\r\n\t\t\t\t\t\t\t\tconfirmText: '授权',\r\n\t\t\t\t\t\t\t\tconfirmColor: '#f94218',\r\n\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t// 选择弹框内授权\r\n\t\t\t\t\t\t\t\t\t\tuni.openSetting({\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res.authSetting)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t} else if (res.cancel) {\r\n\t\t\t\t\t\t\t\t\t\t// 选择弹框内 不授权\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('用户点击不授权')\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t//若有授权\r\n\t\t\t\telse{\r\n\t\t\t\t\t//进入程序主方法\r\n\t\t\t\t\tthat.main();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\t//监听页面隐藏\r\n\tonHide(){\r\n\t\t//离开页面时清除计时器\r\n\t\tclearInterval(this.timer);\r\n\t\tthis.timer = null;\r\n\t\tconsole.log(\"找寻停车场：退出程序1\");\r\n\t\tconsole.log(this.markers);\r\n\t},\r\n\t//监听页面卸载\r\n\tonUnload(){\r\n\t\t//离开页面时清除计时器\r\n\t\tclearInterval(this.timer);\r\n\t\tthis.timer = null;\r\n\t\tconsole.log(\"找寻停车场：退出程序2\");\r\n\t\tconsole.log(this.markers);\r\n\t},\r\n\t\r\n\tmethods:{\r\n\t\t//程序入口\r\n\t\tmain(){\r\n\t\t\tvar that = this;\r\n\t\t\t//获取用户设备高度信息，调整地图大小\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tthat.windowHeight = res.windowHeight;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t//从后台获取停车场信息\r\n\t\t\tthat.GetParkingLotLocations();\r\n\t\t\t//获取最近停车场信息，并进行路径规划\r\n\t\t\tthat.FindCloseParkingLot();\r\n\t\t\t//1秒执行一次获取位置信息，并标记，以模拟导航\r\n\t\t\tthat.timer = setInterval( () => {\r\n\t\t\t    that.MarkCustomerLocation();\t\t\t\r\n\t\t\t}, 2000)\r\n\t\t},\r\n\t\t//获取最近停车场信息，并进行路径规划\r\n\t\tFindCloseParkingLot(){\r\n\t\t\tconsole.log(\"找寻停车场：查询最近停车场信息，并进行路径规划\");\r\n\t\t\tvar that = this;\r\n\t\t\t//获取用户当前位置的经纬度，返回到本地缓存中\r\n\t\t\tthis.GetCustomerLocation();\r\n\t\t\t//用户坐标\r\n\t\t\tvar cl = uni.getStorageSync(\"CustomerLocation\");\r\n\t\t\t//停车场坐标信息\r\n\t\t\tvar parkingLotLocations = uni.getStorageSync(\"parkinglots\");\r\n\t\t\t//定义最短距离\r\n\t\t\tvar minDistance = 1000;\r\n\t\t\t//将最近的有空余车位的停车场找出来\r\n\t\t\tfor(let i=0;i<parkingLotLocations.length;i++){\r\n\t\t\t\tif(parkingLotLocations[i].isFull == 1)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tvar distance = this.ComputeDistance(parkingLotLocations[i],cl);\r\n\t\t\t\t//将最短路径的坐标记录下来\r\n\t\t\t\tif(minDistance>distance){\r\n\t\t\t\t\tminDistance = distance;\r\n\t\t\t\t\t// this.close_empty_pll = parkingLotLocations[i].plLatitude + ',' +  parkingLotLocations[i].plLongitude;\r\n\t\t\t\t\tthis.close_empty_pl = parkingLotLocations[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//路径规划\r\n\t\t\tthis.Direction(cl);\r\n\t\t\t//添加起点终点标记\r\n\t\t\tthis.markers = [\r\n\t\t\t\t//起点标记\r\n\t\t\t\t{\r\n\t\t\t\t\tid:0,\r\n\t\t\t\t\twidth:25,\r\n\t\t\t\t\theight:25,\r\n\t\t\t\t\tlongitude:cl.longitude,\r\n\t\t\t\t\tlatitude:cl.latitude,\r\n\t\t\t\t\ticonPath:'/static/icon/userplace.png',\r\n\t\t\t\t\tcallout:{\r\n\t\t\t\t\t\tcontent:\"出发点\",\r\n\t\t\t\t\t\tfontSize:14,//文本大小\r\n\t\t\t\t\t\tborderRadius:15,//边框圆角\r\n\t\t\t\t\t\tborderWidth:'10',\r\n\t\t\t\t\t\tbgColor:'#1296db',//背景颜色\r\n\t\t\t\t\t\tdisplay:'ALWAYS',//常显\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t//最近且有空余的停车场标记\r\n\t\t\t\t{\r\n\t\t\t\t\tid:1,\r\n\t\t\t\t\twidth:25,\r\n\t\t\t\t\theight:25,\r\n\t\t\t\t\tlongitude:this.close_empty_pl.plLongitude,\r\n\t\t\t\t\tlatitude:this.close_empty_pl.plLatitude,\r\n\t\t\t\t\ticonPath:'/static/icon/userplace.png',\r\n\t\t\t\t\tcallout:{\r\n\t\t\t\t\t\tcontent:\"最近且有空余的停车场：\"+this.close_empty_pl.plName,\r\n\t\t\t\t\t\tfontSize:14,//文本大小\r\n\t\t\t\t\t\tborderRadius:15,//边框圆角\r\n\t\t\t\t\t\tborderWidth:'10',\r\n\t\t\t\t\t\tbgColor:'#1296db',//背景颜色\r\n\t\t\t\t\t\tdisplay:'ALWAYS',//常显\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t//获取用户位置并标记\r\n\t\tMarkCustomerLocation(){\r\n\t\t\tvar that = this;\r\n\t\t\tuni.getLocation({\r\n\t\t\t\ttype: 'wgs84',\r\n\t\t\t\t// geocode: true , //设置该参数为true可直接获取经纬度及城市信息\r\n\t\t\t\t// isHighAccuracy:true,\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tconsole.log(\"用户当前定位信息：\",res);\r\n\t\t\t\t\tthat.userLatitude = res.latitude;\r\n\t\t\t\t\tthat.userLongitude = res.longitude;\r\n\t\t\t\t\t// && that.markers[that.markers.length-1].id != 9990\r\n\t\t\t\t\tif(that.markers.length == 0 || that.markers[that.markers.length-1].id != 9990){\r\n\t\t\t\t\t\tthat.markers.push({\r\n\t\t\t\t\t\t\tid:9990,\r\n\t\t\t\t\t\t\twidth:25,\r\n\t\t\t\t\t\t\theight:25,\r\n\t\t\t\t\t\t\tlongitude:res.longitude,\r\n\t\t\t\t\t\t\tlatitude:res.latitude,\r\n\t\t\t\t\t\t\ticonPath:'/static/icon/user-navi.png',\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthat.markers.pop();\r\n\t\t\t\t\t\tthat.markers.push({\r\n\t\t\t\t\t\t\tid:9990,\r\n\t\t\t\t\t\t\twidth:25,\r\n\t\t\t\t\t\t\theight:25,\r\n\t\t\t\t\t\t\tlongitude:res.longitude,\r\n\t\t\t\t\t\t\tlatitude:res.latitude,\r\n\t\t\t\t\t\t\ticonPath:'/static/icon/user-navi.png',\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail(error) {\r\n\t\t\t\t\tconsole.log('失败', error);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//获取用户位置一次\r\n\t\tGetCustomerLocation(){\r\n\t\t\tvar that = this;\r\n\t\t\tuni.getLocation({\r\n\t\t\t\ttype: 'wgs84',\r\n\t\t\t\tgeocode: true , //设置该参数为true可直接获取经纬度及城市信息\r\n\t\t\t\tisHighAccuracy:true,\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tuni.setStorageSync(\"CustomerLocation\",res)\r\n\t\t\t\t\tthat.userLatitude = res.latitude\r\n\t\t\t\t\tthat.userLongitude = res.longitude\r\n\t\t\t\t},\r\n\t\t\t\tfail(error) {\r\n\t\t\t\t\tconsole.log('失败', error)\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//从后台获取停车场信息\r\n\t\tGetParkingLotLocations(){\r\n\t\t\tconsole.log(\"找寻停车场：开始调用接口\")\r\n\t\t\tvar that = this;\r\n\t\t\tuni.request({\r\n\t\t\t\turl:\"http://localhost:8899/parkinglot/getlist\",\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tconsole.log(\"找寻停车场：获取停车位信息接口（getlist）请求完毕，后台处理完毕，返回处理结果\");\r\n\t\t\t\t\tuni.setStorageSync(\"parkinglots\",res.data);\r\n\t\t\t\t\t// console.log(\"parkinglots:\",res)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//路线规划\r\n\t\tDirection(customerLocation){\r\n\t\t\tvar that = this;\r\n\t\t\t//用户坐标\r\n\t\t\tvar cl = customerLocation.latitude + ',' + customerLocation.longitude;\r\n\t\t\t//停车场坐标\r\n\t\t\tvar pll = this.close_empty_pl.plLatitude + ',' +  this.close_empty_pl.plLongitude;\r\n\t\t\t//路径规划\r\n\t\t\tqqmapsdk.direction({\r\n\t\t\t\tmode:'driving',\r\n\t\t\t\tfrom:cl, //用户当前位置：起点经纬度\r\n\t\t\t\tto:pll, //停车场位置：终点\r\n\t\t\t\tsuccess:function(res){\r\n\t\t\t\t\tvar ret = res;\r\n\t\t\t\t\tvar coors = ret.result.routes[0].polyline, pl = [];\r\n\t\t\t\t\t//坐标解压（返回的点串坐标，通过前向差分进行压缩）\r\n\t\t\t\t\tvar kr = 1000000;\r\n\t\t\t\t\tfor (var i = 2; i < coors.length; i++) {\r\n\t\t\t\t\t  coors[i] = Number(coors[i - 2]) + Number(coors[i]) / kr;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//将解压后的坐标放入点串数组pl中\r\n\t\t\t\t\tfor (var i = 0; i < coors.length; i += 2) {\r\n\t\t\t\t\t  pl.push({ latitude: coors[i], longitude: coors[i + 1] })\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//设置polyline属性，将路线显示出来,将解压坐标第一个数据作为起点\r\n\t\t\t\t\tthat.latitude=pl[0].latitude,\r\n\t\t\t\t\tthat.longitude=pl[0].longitude,\r\n\t\t\t\t\tthat.polyline = [{\r\n\t\t\t\t\t\tpoints: pl,\r\n\t\t\t\t\t\tcolor: '#1296db',\r\n\t\t\t\t\t\twidth: 4\r\n\t\t\t\t\t}] \r\n\t\t\t\t},\r\n\t\t\t\tfail:function(res){\r\n\t\t\t\t\tconsole.log('err',res)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//计算用户位置到停车场的距离\r\n\t\tComputeDistance(parkingLotLocation,customerLocation){\r\n\t\t\t//停车场坐标\r\n\t\t\tvar pll = parkingLotLocation.plLatitude + ',' +  parkingLotLocation.plLongitude;\r\n\t\t\t//用户坐标\r\n\t\t\tvar cl = customerLocation.latitude + ',' + customerLocation.longitude;\r\n\t\t\t//计算距离\r\n\t\t\tvar distance = Math.sqrt( Math.pow((parkingLotLocation.plLatitude-customerLocation.latitude),2) + Math.pow((parkingLotLocation.plLongitude-customerLocation.longitude),2) )\r\n\t\t\treturn distance;\r\n\t\t},\r\n\t\t//提示弹窗\r\n\t\tmessageBox(msgType,messageText){\r\n\t\t\tthis.msgType = msgType\r\n\t\t\tthis.messageText = messageText\r\n\t\t\tthis.$refs.message.open();\r\n\t\t},\r\n\t}\r\n\t\r\n}\n</script>\n\n<style>\r\n\t#mymap{\r\n\t\twidth: 100%;\r\n\t}\n</style>","import mod from \"-!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkingLotNavigation.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\applicationDownload\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./parkingLotNavigation.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1681622629773\n      var cssReload = require(\"D:/applicationDownload/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}